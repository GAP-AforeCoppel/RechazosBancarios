<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de rechazo bancario Afore Coppel</title>
    
    <!-- 1. Estilos y Fuentes -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- 2. Librerías Externas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f3f4f6; 
            -webkit-font-smoothing: antialiased; 
            -moz-osx-font-smoothing: grayscale;
        }
        .shadow-premium { box-shadow: 0 20px 60px -15px rgba(0, 0, 0, 0.2); }
        .fade-in { animation: fadeIn 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        const App = () => {
            const [copyStatus, setCopyStatus] = useState('idle');
            const cardRef = useRef(null);

            // --- UTILIDADES ---
            const formatDate = (dateString) => {
                if (!dateString) return '';
                const [year, month, day] = dateString.split('-');
                const date = new Date(year, month - 1, day);
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                const formattedDate = date.toLocaleDateString('es-ES', options);
                return formattedDate.charAt(0).toUpperCase() + formattedDate.slice(1);
            };

            // --- COMPONENTE DE IMAGEN ---
            const StepImage = ({ src, placeholderText, isRejected }) => {
                const [imgError, setImgError] = useState(false);
                return (
                    <div className="w-full h-full flex items-center justify-center p-6">
                        {imgError ? (
                            <div className={`w-full h-full flex flex-col items-center justify-center rounded-lg border-2 border-dashed ${isRejected ? 'border-red-200 bg-red-50/50' : 'border-slate-200 bg-slate-50/50'} text-slate-400 p-4`}>
                                <span className="text-[10px] font-bold text-center uppercase tracking-wider opacity-50">{placeholderText}</span>
                            </div>
                        ) : (
                            <img 
                                src={src} 
                                alt={placeholderText} 
                                className="max-w-full max-h-full object-contain pointer-events-none"
                                onError={() => setImgError(true)} 
                            />
                        )}
                    </div>
                );
            };

            const StepNumber = ({ number, type }) => (
                <div className="absolute top-2 left-4 z-20">
                    <svg width="50" height="50" viewBox="0 0 50 50" className="drop-shadow-md">
                        <circle cx="25" cy="25" r="24" fill={type === 'success' ? "#22c55e" : "#ef4444"} stroke="white" strokeWidth="2" />
                        <text x="50%" y="52%" textAnchor="middle" dominantBaseline="middle" fill="white" fontSize="20" fontWeight="800" fontFamily="Arial, sans-serif">{number}</text>
                    </svg>
                </div>
            );

            const StatusLabel = ({ type }) => {
                const isSuccess = type === 'success';
                const colorBg = isSuccess ? "#f0fdf4" : "#fef2f2";
                const colorBorder = isSuccess ? "#bbf7d0" : "#fecaca";
                const colorText = isSuccess ? "#15803d" : "#dc2626";
                const labelText = isSuccess ? "COMPLETADO" : "INCOMPLETO";

                return (
                    <div className="absolute top-2 right-4 z-20">
                        <svg width="150" height="46" viewBox="0 0 150 46" fill="none" xmlns="http://www.w3.org/2000/svg" style={{ filter: 'drop-shadow(0px 2px 4px rgba(0,0,0,0.1))' }}>
                            <rect x="5" y="5" width="140" height="34" rx="17" fill={colorBg} stroke={colorBorder} strokeWidth="1.5" />
                            {isSuccess ? (
                                <path d="M22 21L26 25L33 17.5" stroke={colorText} strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"/>
                            ) : (
                                <g transform="translate(19, 14)">
                                    <circle cx="8" cy="8" r="7" stroke={colorText} strokeWidth="1.5"/>
                                    <path d="M5.5 5.5L10.5 10.5M10.5 5.5L5.5 10.5" stroke={colorText} strokeWidth="1.5" strokeLinecap="round"/>
                                </g>
                            )}
                            <text 
                                x="88" 
                                y="23" 
                                fill={colorText} 
                                fontFamily="'Inter', sans-serif" 
                                fontSize="12" 
                                fontWeight="900" 
                                letterSpacing="0.05em" 
                                textAnchor="middle" 
                                dominantBaseline="middle"
                            >
                                {labelText}
                            </text>
                        </svg>
                    </div>
                );
            };

            // --- CATÁLOGOS ---
            const SERVICE_TYPES = [
                { id: 'retiro_desempleo', label: 'Retiro por Desempleo' },
                { id: 'retiro_matrimonio', label: 'Retiro por Matrimonio' },
                { id: 'retiro_total', label: 'Retiro Total' },
                { id: 'retiro_voluntario', label: 'Retiro de Aportaciones Voluntarias' },
                { id: 'retiro_sar', label: 'Retiro SAR 92' }
            ];

            const REJECTION_CATALOG = [
                { id: 4, label: "El número de cuenta no existe", comment: "Tu banco no reconoce el número de cuenta proporcionado. Por favor, envía un estado de cuenta vigente de una cuenta distinta." },
                { id: 5, label: "Cuenta bloqueada", comment: "Tu banco tiene restringidos los depósitos. Acude a tu sucursal para desbloquearla o envíanos una cuenta nueva." },
                { id: 6, label: "Cuenta cancelada", comment: "La cuenta registrada ya no está vigente. Es necesario que nos proporciones un nuevo estado de cuenta para realizar tu pago." },
                { id: 10, label: "Cuenta inactiva", comment: "Tu cuenta no ha tenido movimientos recientemente. Solicita su reactivación en el banco o envíanos una cuenta nueva." },
                { id: 11, label: "Cuenta inexistente", comment: "Tu banco no reconoce el número de cuenta proporcionado. Por favor, envía un estado de cuenta vigente de una cuenta distinta." },
                { id: 12, label: "Cuenta bloqueada", comment: "Tu banco tiene restringidos los depósitos. Acude a tu sucursal para desbloquearla o envíanos una cuenta nueva." },
                { id: 13, label: "Cuenta cancelada", comment: "La cuenta registrada ya no está vigente. Es necesario que nos proporciones un nuevo estado de cuenta para realizar tu pago." },
                { id: 15, label: "Cuenta con otra divisa", comment: "El depósito solo puede realizarse en Pesos Mexicanos. Proporcionanos una cuenta bancaria nacional en moneda nacional." },
                { id: 16, label: "Cuenta no pertenece al banco", comment: "Los datos de la cuenta no coinciden con la institución bancaria seleccionada. Envía una nueva cuenta para corregirlo." },
                { id: 24, label: "Falta información mandatoria para completar el pago", comment: "El banco requiere datos adicionales para procesar el pago. Acude a tu banco para actualizar tu información o envía una cuenta nueva." },
                { id: 27, label: "Tipo de cuenta no corresponde", comment: "La cuenta proporcionada no permite este tipo de depósitos. Valida con tu banco o proporciónanos una cuenta diferente." },
                { id: 30, label: "Excede el límite de saldo autorizado de la cuenta", comment: "El depósito supera el límite de dinero permitido en tu cuenta. Solicita ampliar el límite de depósitos en tu banco o envía una cuenta distinta." },
                { id: 31, label: "Excede el límite de abono permitido por mes en la cuenta", comment: "El depósito supera el límite de dinero permitido en tu cuenta. Solicita ampliar el límite de depósitos en tu banco o envía una cuenta distinta." },
                { id: 7, label: "Error en el RFC", comment: "El RFC en tu solicitud no coincide con el registrado en tu banco. Solicita la corrección de tus datos en el banco o envíanos una cuenta nueva." }
            ];

            const [data, setData] = useState({
                workerName: 'María González',
                deadlineDate: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                serviceType: SERVICE_TYPES[0].label,
                selectedRejectionId: 5,
                customAction: REJECTION_CATALOG[1].comment,
            });

            // --- LÓGICA DE COPIADO ---
            const handleCopy = async () => {
                setCopyStatus('copying');
                try {
                    const canvas = await html2canvas(cardRef.current, {
                        scale: 2.5,
                        backgroundColor: '#ffffff',
                        useCORS: true,
                        logging: false,
                        width: cardRef.current.offsetWidth,
                        height: cardRef.current.scrollHeight
                    });
                    const dataUrl = canvas.toDataURL('image/png');
                    
                    const img = document.createElement('img');
                    img.src = dataUrl;
                    img.contentEditable = true;
                    const div = document.createElement('div');
                    div.contentEditable = true;
                    div.style.position = 'fixed'; div.style.left = '-9999px'; div.style.top = '0px'; div.style.opacity = '0';
                    div.appendChild(img);
                    document.body.appendChild(div);
                    const range = document.createRange(); range.selectNodeContents(div);
                    const selection = window.getSelection(); selection.removeAllRanges(); selection.addRange(range);
                    document.execCommand('copy');
                    document.body.removeChild(div);
                    selection.removeAllRanges();
                    setCopyStatus('success');
                    setTimeout(() => setCopyStatus('idle'), 2500);
                } catch (error) {
                    console.error("Error al copiar imagen:", error);
                    setCopyStatus('idle');
                }
            };

            return (
                <div className="min-h-screen flex flex-col bg-slate-100 pb-10">
                    {/* Barra de Control */}
                    <div className="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm py-3 px-6">
                        <div className="max-w-[1400px] mx-auto flex flex-wrap items-center justify-between gap-4">
                            <div className="flex items-center gap-3">
                                <img src="logoafore.png" alt="Logo" className="h-8 object-contain" />
                                <span className="text-sm font-bold text-[#00529B] hidden md:inline tracking-tighter uppercase italic text-xs">Generador de rechazo bancario Afore Coppel</span>
                            </div>
                            <div className="flex items-center gap-3 text-sm flex-wrap justify-end flex-1">
                                <input type="text" value={data.workerName} onChange={(e) => setData({...data, workerName: e.target.value})} className="border rounded px-2 py-1.5 bg-slate-50 w-40 text-xs outline-none focus:ring-1 focus:ring-blue-400" />
                                <select onChange={(e) => setData({...data, serviceType: SERVICE_TYPES.find(s => s.id === e.target.value).label})} className="border rounded px-2 py-1.5 bg-slate-50 text-xs">
                                    {SERVICE_TYPES.map(s => <option key={s.id} value={s.id}>{s.label}</option>)}
                                </select>
                                <select value={data.selectedRejectionId} onChange={(e) => {
                                    const id = parseInt(e.target.value);
                                    setData({...data, selectedRejectionId: id, customAction: REJECTION_CATALOG.find(r => r.id === id).comment});
                                }} className="border rounded px-2 py-1.5 bg-blue-50 text-[#00529B] font-bold text-xs">
                                    {REJECTION_CATALOG.map((r) => <option key={r.id} value={r.id}>{r.label}</option>)}
                                </select>
                                <input type="date" value={data.deadlineDate} onChange={(e) => setData({...data, deadlineDate: e.target.value})} className="border rounded px-2 py-1.5 bg-yellow-50 text-xs" />
                                <button onClick={handleCopy} disabled={copyStatus === 'copying'} className={`font-semibold px-5 py-1.5 rounded-md shadow-lg active:scale-95 transition-all text-xs ${copyStatus === 'success' ? 'bg-green-600 text-white' : 'bg-[#00529B] text-white'}`}>
                                    {copyStatus === 'copying' ? 'Procesando...' : copyStatus === 'success' ? '¡Listo!' : 'Copiar Imagen'}
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Canvas de la Imagen */}
                    <div className="flex-1 flex flex-col items-center justify-center p-8 overflow-auto">
                        <div ref={cardRef} className="bg-white w-[1000px] shadow-2xl flex flex-col relative overflow-hidden shrink-0 border border-slate-200">
                            
                            {/* Header */}
                            <div className="bg-[#00529B] px-12 py-8 text-center text-white border-b-[8px] border-[#FFE600] relative z-20">
                                <img src="logoafore.png" alt="Afore Coppel" className="absolute top-2 left-12 h-16 w-auto object-contain z-30 brightness-0 invert" />
                                <div className="relative z-10 pt-2 mx-auto max-w-2xl">
                                    <h2 className="text-4xl font-black tracking-tight leading-none mb-2">Estatus de tu Solicitud</h2>
                                    <p className="text-blue-100 text-base font-light tracking-wide opacity-90">
                                        Hola <strong className="font-bold text-white uppercase tracking-tight underline underline-offset-4 decoration-[#FFE600]">{data.workerName}</strong>, este es el seguimiento de tu trámite de <span className="font-medium text-white italic">{data.serviceType}</span>:
                                    </p>
                                </div>
                            </div>

                            <div className="px-12 py-10 bg-slate-50 relative">
                                <div className="grid grid-cols-2 gap-8 relative z-10">
                                    {[
                                        { n: "1", t: "Solicitud Recibida", d: "Recibimos tu solicitud para validar el trámite.", p: "paso1.png" },
                                        { n: "2", t: "Validación Aprobada", d: "Afore Coppel validó los requisitos normativos.", p: "paso2.png" },
                                        { n: "3", t: "Solicitud de Pago", d: "Transferencia enviada a tu cuenta de banco.", p: "paso3.png" }
                                    ].map(step => (
                                        <div key={step.n} className="bg-green-50/50 rounded-3xl border-2 border-green-200 flex flex-col items-center overflow-hidden shadow-sm relative">
                                            <StepNumber number={step.n} type="success" />
                                            <StatusLabel type="success" />
                                            <div className="w-full h-64 bg-white border-b border-green-50">
                                                <StepImage src={step.p} placeholderText={step.t} isRejected={false} />
                                            </div>
                                            <div className="w-full py-5 px-6 text-center min-h-[110px]">
                                                <h3 className="text-green-800 font-bold text-xl tracking-tight mb-1 italic uppercase">{step.t}</h3>
                                                <p className="text-sm text-green-700 font-medium leading-snug">{step.d}</p>
                                            </div>
                                        </div>
                                    ))}

                                    <div className="bg-red-50 rounded-3xl border-2 border-red-400 flex flex-col items-center overflow-hidden shadow-md relative group ring-4 ring-red-100/30">
                                        <StepNumber number="4" type="error" />
                                        <StatusLabel type="error" />
                                        <div className="w-full h-64 p-4 bg-white border-b border-red-100">
                                            <StepImage src="paso4.png" placeholderText="Rechazo Bancario" isRejected={true} />
                                        </div>
                                        <div className="w-full py-5 px-6 flex flex-col items-center justify-center text-center min-h-[110px]">
                                            <h3 className="text-red-600 font-black text-xl tracking-tight mb-1 uppercase italic">Rechazo Bancario</h3>
                                            <p className="text-sm text-red-900 font-medium tracking-tight leading-snug">
                                                La tarjeta bancaria que proporcionaste presentó un rechazo por: <br/>
                                                <span className="font-extrabold uppercase text-[15px] block mt-1">
                                                    {REJECTION_CATALOG.find(r => r.id === data.selectedRejectionId)?.label}
                                                </span>
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div className="bg-white px-12 pt-10 pb-8 border-t border-slate-200 shrink-0 relative z-20 flex flex-col gap-6">
                                <div className="flex gap-8 items-stretch">
                                    {/* SECCIÓN ACCIÓN A SEGUIR - FOCO (BOMBILLA) */}
                                    <div className="flex-1 flex gap-5 bg-red-50/60 p-6 rounded-2xl border border-red-100/80 items-start shadow-sm">
                                        <div className="shrink-0">
                                            <svg width="60" height="88" viewBox="0 0 104 154" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M103 50.2063C103 22.7653 79.7276 0.576872 51.1891 1.00612C24.1553 1.41196 1.91828 22.4766 1.02848 48.5439C0.648291 59.6576 4.09426 69.9753 10.1854 78.373C18.0561 89.2214 22.0764 102.232 22.0764 115.468V115.991H81.9278V115.991V115.468C81.9278 102.286 85.8511 89.2761 93.7218 78.4979C99.5621 70.4982 103 60.7425 103 50.2063Z" fill="#F0EFEF" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M22.3047 114.615V132.635C22.3047 140.918 29.4401 147.633 38.2421 147.633H39.5608C41.1869 150.808 44.6252 153 48.6217 153H57.3914C61.3879 153 64.8342 150.8 66.4522 147.625C75.1491 147.511 82.1632 140.85 82.1632 132.643V114.615H22.3047Z" fill="#FFDD35" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M23 127H81.5" stroke="black" stroke-width="2"/>
                                                <path d="M57.2812 114.592L67.8618 60.0845" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M35.8633 60.2095L47.6249 114.592" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M35.9336 60.0381C38.5868 60.0381 38.5868 67.8427 41.2401 67.8427C43.8933 67.8427 43.8933 60.0381 46.5465 60.0381C49.1998 60.0381 49.1998 67.8427 51.853 67.8427C54.5062 67.8427 54.5062 60.0381 57.1595 60.0381C59.8127 60.0381 59.8127 67.8427 62.474 67.8427C65.1353 67.8427 65.1272 60.0381 67.7886 60.0381" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <rect x="22" y="111" width="60" height="3" fill="black"/>
                                            </svg>
                                        </div>
                                        <div>
                                            <p className="text-red-800 text-xs font-bold uppercase tracking-widest mb-2">ACCIÓN A SEGUIR</p>
                                            <p className="text-slate-700 text-sm leading-relaxed font-semibold text-left italic">"{data.customAction}"</p>
                                        </div>
                                    </div>
                                    
                                    {/* NOTA IMPORTANTE - CAMPANA */}
                                    <div className="flex-1 flex gap-5 bg-blue-50/60 p-6 rounded-2xl border border-blue-100/80 items-start shadow-sm">
                                        <div className="shrink-0">
                                            <svg width="60" height="80" viewBox="0 0 104 138" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M70.6562 118.376C70.6562 128.23 62.4188 136.275 52.1836 136.275C41.9483 136.275 33.7109 128.23 33.7109 118.376C33.7109 108.521 41.9483 100.477 52.1836 100.477C62.4188 100.477 70.6562 108.521 70.6562 118.376Z" fill="#FFDD35" stroke="black" stroke-width="2"/>
                                                <path d="M61.7082 13.3129C61.7082 20.3072 57.0117 25.618 51.6295 25.618C46.2472 25.618 41.5508 20.3072 41.5508 13.3129C41.5508 6.31867 46.2472 1.00781 51.6295 1.00781C57.0117 1.00781 61.7082 6.31867 61.7082 13.3129Z" stroke="black" stroke-width="2"/>
                                                <path d="M1.43715 65.2645C1.43715 37.4812 23.98 14.9565 51.7859 14.9565C79.5917 14.9565 102.135 37.4812 102.135 65.2645V120.079C102.135 121.911 100.644 123.401 98.8097 123.401H4.75452C2.92068 123.401 1.42969 121.911 1.42969 120.079V65.2645H1.43715Z" fill="#FFDD35" stroke="black" stroke-width="2"/>
                                                <path d="M85.186 34.5635C94.4618 34.5635 101.981 27.05 101.981 17.7817C101.981 8.51344 94.4618 1 85.186 1C75.9102 1 68.3906 8.51344 68.3906 17.7817C68.3906 27.05 75.9102 34.5635 85.186 34.5635Z" fill="#FF8575" stroke="black" stroke-width="2"/>
                                            </svg>
                                        </div>
                                        <div>
                                            <p className="text-[#00529B] text-xs font-bold uppercase tracking-widest mb-2">Nota Importante</p>
                                            <p className="text-slate-700 text-sm leading-relaxed font-medium text-left">
                                                Es necesario corregir esta situación directamente con tu banco y notificarnos. O bien, envía un nuevo estado de cuenta al correo: <span className="font-bold text-[#00529B] underline italic">ueapcoppel@aforecoppel.com</span>.
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div className="flex justify-center mt-2 mb-2">
                                    <div className="flex flex-col items-center bg-[#FFE600] border-2 border-yellow-400 rounded-2xl px-8 py-3 shadow-sm transform hover:scale-105 transition-transform">
                                        <div className="flex items-center gap-2 mb-1">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-[#00529B]"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                                            <span className="text-[#00529B] text-[11px] font-black uppercase tracking-[0.2em]">FECHA LÍMITE DE ENVÍO</span>
                                        </div>
                                        <div className="text-[#00529B] font-black text-2xl tracking-tighter italic uppercase">{formatDate(data.deadlineDate)}</div>
                                    </div>
                                </div>
                            </div>
                            <div className="h-[8px] w-full bg-[#FFE600]"></div>
                        </div>

                        <div className="mt-8 text-slate-400 text-[10px] font-medium uppercase tracking-widest text-center opacity-60">
                            Gerencia de Atención al Público - Afore Coppel
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>







